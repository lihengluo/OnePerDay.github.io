# ==计算机网络==

---

## [第一章：计算机网络和因特网](./doc/计算机网络ppt/第1章 计算机网络与因特网（完整版）.pptx)

#### ==2023.8.30==

#### 网络接入：描述网络接入的方式

**接入介质**

**p2p**

**局域网/城域网/广域网**

**单工/半双工/全双工**：对两端数据交换方式的描述

![image-20230830170143664](./assets/image-20230830170143664.png)

#### 网络交换

**电路交换：**双方都需要打开连接才能发送数据

电路交换的复用：TDM FDM

<img src="./assets/image-20230830170704702.png" alt="image-20230830170704702" style="zoom: 33%;" />

**分组交换：**在数据发送到下一个路由（称为下一跳），最后发送到终点端。数据可以切分为更多的组，提升容错率，但同时交换协议会更加复杂。

<img src="./assets/image-20230830170915628.png" alt="image-20230830170915628" style="zoom: 33%;" />

#### ==**2023.9.7**==

#### 网络核心:

**ISP和互联网主干：**注意IXP，ISP的概念

<img src="./assets/image-20230906224435945.png" alt="image-20230906224435945" style="zoom:50%;" />

#### 时延、丢包数和吞吐量

**时延：**四种时延

<img src="./assets/image-20230906224644004.png" alt="image-20230906224644004" style="zoom:50%;" />

- 注意区分传输时延和传播时延的区别
- 会计算排队时延

**丢包：**缓冲区溢出采用的策略

**吞吐量：**目前瓶颈集中在主干网络

#### 层次化的网络结构

<img src="./assets/image-20230906225144883.png" alt="image-20230906225144883" style="zoom:75%;" />

**TCP/IP层次：**4层

**教材：**5层

<img src="./assets/image-20230906225341504.png" alt="image-20230906225341504" style="zoom:75%;" />

- 应用层（Application）:运行不同程序之间的通信，HTTP ==message==
- 传输层（Transport）：不同进程间的数据传输协议。TCP、UDP，保证数据正确传输 ==segement==
- 网络层（Network）：不同局域网，不同主机之间的通信协议，IP ==datagram==
- 链路层（Link）：数据在网络相邻结点之间传输，Ethernet ==data==
- 物理层（Phsical）：将数据转换成物理信号的协议 ==bitstream==

**传输格式的变换：**

<img src="./assets/image-20230906230145391.png" alt="image-20230906230145391" style="zoom:60%;" />

链路层加上了校验码（CRC or CheckSum）

**ISO-OSI：**7层

## [第二章：应用层：应用与应用的通信](./doc/计算机网络ppt/第2章 应用层（完整版）.pptx)

#### ==2023.9.11==

#### 应用层协议

应用层之间发起了信息通信的请求，给出了双方的主机地址和端口号，进行了报文的交换

传输层接收到了目标地址，和对方的某个确定进程进行通信

网络层负责两个主机之间的通信，给定两个进程（端口）和主机地址

链路层负责数据的传输方式

#### Web

**Web**

#### HTTP

**连接方式**

**请求报文**

**响应报文**

**cookie**

## [第三章：运输层：进程到进程的通信](./doc/计算机网络ppt/第3章 运输层（完整版）.pptx)

#### ==2023.9.13==

#### C/S模式

**服务器：**接收来自客户端的请求，并提供服务

**datacenter：**服务器群，处理海量数据

#### B/S模式

**browser**

#### 运输层概述

#### 多路复用与多路分解

**IP地址：**标识主机的接口（有线，无线）

**端口号**：唯一标识一个进程

**Socket：**IP+端口

**报文段的复用**

#### UDP：多路复用，差错检查

**无连接**，只发送，**无拥塞控制**

优势：简单，开销小，速度快

缺点：分组溢出，减小TCP通信速率

**报文段（数据报）结构**

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230927143831724.png" alt="image-20230927143831724" style="zoom:44%;" />

**检查和：**相加，对进位进行回卷，对结果取反作为检查和

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230925150203298.png" alt="image-20230925150203298" style="zoom:40%;" />

#### ==可靠数据传输==

分组：Network Packet

***前提：**分组是顺序发送，没有并行*

**指标：**不出错，，不丢失；不考虑性能和安全

**传输协议流程：**

**开发协议（分情况）**

- **可信信道：只用传输数据 send and receive rdt1.0

- **出错但不丢失：rdt2.x** 

- 检测 反馈（ACK NAK） 重传 rdt2.0

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230925143701454.png" alt="image-20230925143701454" style="zoom:40%;" />

- rdt2.1
    - 可以使用buffer or cache 保存发送但未确认的分组

    - ACK也可以进行流量控制，接收方控制发送方速率

    - 用ID可以区分重复的分组（由于分组连续，1个bit即可）


-   rdt2.2 没有NAK
    - ACK 0 代表期待ACK1， double ACK 0 代表1出错，未达到预期
-   **出错且丢失：rdt3.0**

    - 增加超时重传
-   **实现机制**

    - 检错
    - 响应
    - 检测
    - 重传
    - 序号
-   **rdt3.0性能低下（传播时延远大于传输时延）**

    -   流水线技术（GBN， SR）
    -   序号管理
    -   GBN
    -   SR


​                                             <img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230925153538954.png" alt="image-20230925153538954" style="zoom:40%;" />

<center>一般情况下流水线序号管理</center>

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230925155249092.png" alt="image-20230925155249092" style="zoom:30%;" />

<center>SR协议序号管理</center>

#### TCP：面向连接的传输

**特征：**

-   对字节编号，segment的编号不连续

**报文段结构：可变长**

-   窗口类似于GBN，但是会缓存乱序报文段

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230927145919027.png" alt="image-20230927145919027" style="zoom:40%;" />

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230927145952296.png" alt="image-20230927145952296" style="zoom:40%;" />

**超时设置：RTT估计**



<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230927151055779.png" alt="image-20230927151055779" style="zoom:40%;" />

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230927151159060.png" alt="image-20230927151159060" style="zoom:30%;" />

**可信数据传输**

**快速重传**

-   triple ACK && Timeout 
    -   ACK意味着至少有一些报文段成功被接收（轻度）
    -   Timeout意味着没有报文段成功（重度）

**流量控制**

-   试探一个字节

**TCP连接：三次握手**

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20230927160137432.png" alt="image-20230927160137432" style="zoom:40%;" />

**拥塞控制（端到端）：**

-   TCP通过丢包和时延增加等现象进行判断
-   拥塞窗口：发送窗口应该小于拥塞窗口
-   Reno算法：慢启动，指数增加
-   加性增，乘性减
-   **对Timeout/tripple ACK事件，门限制值的设置和策略不同**

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231009144036161.png" alt="image-20231009144036161" style="zoom:40%;" />

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231009144600610.png" alt="image-20231009144600610" style="zoom:30%;" />

## [第四章：网络层：主机与主机之间的通信]()

网络层不保证数据传输的安全和速度/深入网络内部

**目标：**如何选路？/如何转发？/是否可达？

### 虚电路和数据报网络

#### 虚电路

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231011142118189.png" alt="image-20231011142118189" style="zoom:40%;" />

基于流的选路：固定路径进行传播，使用VC号进行链路的确定

#### 数据报（蓬勃发展！）

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231011143655921.png" alt="image-20231011143655921" style="zoom:40%;" />

路由使用选路算法为不同分组进行选路

### 路由器

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231011144158299.png" alt="image-20231011144158299" style="zoom:40%;" />

在交换结构中可以实现链路协议的转换

总线交换：输入报文经共享总线将分组直接转发到输出端口。

### IP数据报格式

#### 报文格式

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231016140704879.png" alt="image-20231016140704879" style="zoom:40%;" />

MTU：网络层每个数据报的最大长度

#### 分片机制

使用标识、标志、片偏移进行大分组的分片

### IP地址

IP地址和逻辑接口（蓝牙、WIFI网卡、虚拟网卡）有关，和主机和路由无关

点分十进制表示

通过ABCD进行IP的分组（网络号和主机号）：

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231016151522030.png" alt="image-20231016151522030" style="zoom:40%;" />

网络地址：名词

广播地址：地址

0.0.0.0：任意地址

单播地址/广播/组播地址：一对一/一对多通讯方式

使用手段减少IP需求量（NAT/DHCP）

#### IPV6报文格式

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231016151434457.png" alt="image-20231016151434457" style="zoom:40%;" />

IPV4-IPV6:双栈协议，隧道技术

### 子网划分

将某一类的地址块进行切分。

从主机号中切出一部分作为子网号：子网号地址从1-14，**至少留2位做主机地址**

网络*号是网段中的第一个*地址*，*广播地址*是网段中的最后一个*地址*，这两个*地址*是不能配置在计算机主机上的。

子网掩码：通过掩码确定子网号和主机号（求与）

网络前缀+主机号

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231016153256812.png" alt="image-20231016153256812" style="zoom:30%;" />

在同一个网络中的IP网络号相同

H1分组发送过程，通过主机地址和子网掩码执行AND操作进行匹配

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231018144121567.png" alt="image-20231018144121567" style="zoom:30%;" />

### 无类域间路由：CIDR

斜线记法：192.168.0.1/24（网络地址+网络前缀长度）

多条记录都可以匹配，去匹配长度最长的作为下一跳

获得IP地址的方法：

-   手工配置
-   DHCP配置

### 网络地址转换NAT

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231018152557773.png" alt="image-20231018152557773" style="zoom:40%;" />

家用的无限路由不支持自主选路

#### 访问内网的方案

-   端口映射
-   使用中继（Skype）

### ICMP协议（差错与控制报文协议）

#### 报文格式

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231023140433627.png" alt="image-20231023140433627" style="zoom:40%;" />

-   不可达报文

-   参数出错报文

-   重定向报文（有多个通道，路由转发过程中发现源主机可以将报文直接发送给下游路由节点）

-   ping/traceroute


### ==选路算法==

>   tips:此处的选路算法是互联网内的选路，局域网之间的选路将在下章进行讲解。

将网络拓扑映射成抽象图——找图上最短路

分类：全局/分散、动态/静态、负载、

#### 链路状态选路算法

1.   Dijkstra’s(迪克斯特拉)算法：

**前提**-所有节点都知道网络拓扑和链路费用

**问题**-最优选路受网络流量影响，变动频繁

2.   OSPF选路算法（解决上述问题）

**特征**-协议消息采用洪泛法发送

#### 距离向量选路算法

无法看到全局图，只能看到部分

通过递归得到最优的选路（类似DP）

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231023151447130.png" alt="image-20231023151447130" style="zoom:30%;" />

#### RIP路由表更新算法

**问题：**好消息传得快，坏消息传得慢

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231023152233146.png" alt="image-20231023152233146" style="zoom:30%;" />

举例：z会误导y，导致不能一次进行更新

解决——毒性逆转：z会通告y，y不能通过z到x获得最短选路。

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231023153018165.png" alt="image-20231023153018165" style="zoom:20%;" />

在上述情况中，尽管具有毒性逆转，BCDE节点仍可能进入死循环。（此时N节点offline了）



<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231023152828116.png" alt="image-20231023152828116" style="zoom:40%;" />

**边权重均为1**

基于UDP，标注应用进程，说明**RIP协议工作在应用层**上

路由器设备：逻辑上三层设备，只负责数据的转发

### BGP-4

#### 层次路由

自治系统

内部网关协议IGP（自治系统内部选路）

AS内选路和AS间选路

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231025141710874.png" alt="image-20231025141710874" style="zoom:30%;" />

层次OSPF

BGP和发言人

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231025142522913.png" alt="image-20231025142522913" style="zoom:40%;" />

BGP发言人交换路径向量（完整路径）

## 第五章：软件定义网络

## 第六章：链路层

### 概述

节点：主机和路由器

链路：沿着通信路径连接相邻节点的通信信道

PDU：协议数据单元 

-   报文
-   UDP数据报/TCP报文段
-   数据报
-   帧（以太网专用）
-   比特流

SDU：服务数据单元

链路层：链路层负责将数据报封装成帧通过链路从一个节点传输到物理上相邻的下一个节点。

链路选择：以误码率进行区分

提供服务：

-   

RDMA

CFMA

### 多路访问链路和协议

#### 信道划分协议

TDMA/FDMA

#### 随机访问

ALOHA

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231101140738721.png" alt="image-20231101140738721" style="zoom:40%;" />

载波监听CCMA，三种策略

-   非坚持
-   1坚持：（常用）容易产生冲突
-   P坚持：有概率坚持监听

碰撞示意图：2$\tau$(争用期)过后是安全时间（需要持续发送数据）

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231101142310386.png" alt="image-20231101142310386" style="zoom:40%;" />

检测到碰撞后的处理：

-   停止发送帧
-   强化碰撞（干扰信号
-   随机延迟一段时间后重发

#### 轮流协议

轮询协议：主节点邀请从节点轮流传输（有顺序）

令牌传递协议：控制令牌一次通过节点

### 交换局域网

#### MAC地址

作用：在数据链路层标识每块网络适配器，使得能够在广播信道上寻址目标节点

MAC地址不改变（烧入网卡中），IP地址会改变

#### 地址解析协议ARP

局域网内

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231101151451305.png" alt="image-20231101151451305" style="zoom:40%;" />

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231101150602244.png" alt="image-20231101150602244" style="zoom:40%;" />

局域网间：路由器不转发ARP请求，**因为链路层只关注主机Y到路由器**

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231101150806607.png" alt="image-20231101150806607" style="zoom:40%;" />

互联网间：同上面类似

### 以太网

总线式/交换式

帧结构：

<img src="/Users/apple/Desktop/OnePerDay.github.io/assets/image-20231101152859133.png" alt="image-20231101152859133" style="zoom:40%;" />

服务：无连接服务/不可靠服务

工作原理：载波监听、碰撞检测、随机回退



